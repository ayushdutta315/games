<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Pacman Arcade</title>
<style>
body { margin:0; background:black; text-align:center; color:white; font-family:Arial; }
canvas { background:black; display:block; margin:auto; }
#startScreen {
 position:fixed;
 top:0; left:0;
 width:100%; height:100%;
 background:black;
 display:flex;
 justify-content:center;
 align-items:center;
 flex-direction:column;
}
button { padding:12px 25px; font-size:18px; }
</style>
</head>
<body>

<div id="startScreen">
<h1>ðŸŽ® PACMAN</h1>
<button onclick="startGame()">Start Game</button>
</div>

<h3>
Score: <span id="score">0</span> |
Lives: <span id="lives">3</span>
</h3>

<canvas id="game" width="600" height="600"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const tile = 30;
const rows = 20;
const cols = 20;

let map = [];
let pacman;
let ghosts;
let score = 0;
let lives = 3;
let running = false;
let ghostMoveCounter = 0;

function generateMap(){
 map = [];
 for(let r=0;r<rows;r++){
  map[r]=[];
  for(let c=0;c<cols;c++){
   if(r===0||r===rows-1||c===0||c===cols-1||(r%4===0&&c%3!==0))
    map[r][c]=1;
   else
    map[r][c]=2;
  }
 }
}

function resetPositions(){
 pacman = {x:1,y:1,dx:0,dy:0};
 ghosts = [
  {x:18,y:18,color:"red"},
  {x:18,y:1,color:"cyan"}
 ];
}

function startGame(){
 document.getElementById("startScreen").style.display="none";
 generateMap();
 resetPositions();
 running = true;
}

document.addEventListener("keydown", e=>{
 if(e.key==="ArrowUp")    { pacman.dx=0; pacman.dy=-1; }
 if(e.key==="ArrowDown")  { pacman.dx=0; pacman.dy=1; }
 if(e.key==="ArrowLeft")  { pacman.dx=-1; pacman.dy=0; }
 if(e.key==="ArrowRight") { pacman.dx=1; pacman.dy=0; }
});

function update(){

 if(!running) return;

 let nx = pacman.x + pacman.dx;
 let ny = pacman.y + pacman.dy;

 if(map[ny][nx] !== 1){
  pacman.x = nx;
  pacman.y = ny;
 }

 if(map[pacman.y][pacman.x] === 2){
  map[pacman.y][pacman.x] = 0;
  score += 10;
 }

 document.getElementById("score").innerText = score;
 document.getElementById("lives").innerText = lives;

 // Slow ghost movement
 ghostMoveCounter++;
 if(ghostMoveCounter % 15 === 0){
  ghosts.forEach(g=>{
   let dx = pacman.x - g.x;
   let dy = pacman.y - g.y;

   let moveX = dx !== 0 ? dx/Math.abs(dx) : 0;
   let moveY = dy !== 0 ? dy/Math.abs(dy) : 0;

   let tryMove = Math.random()<0.5 ? [moveX,0] : [0,moveY];

   if(map[g.y+tryMove[1]][g.x+tryMove[0]] !== 1){
    g.x += tryMove[0];
    g.y += tryMove[1];
   }

   if(g.x===pacman.x && g.y===pacman.y){
    lives--;
    if(lives<=0){
     alert("Game Over! Score: "+score);
     location.reload();
    }else{
     resetPositions();
    }
   }
  });
 }

}

function draw(){
 ctx.clearRect(0,0,600,600);

 for(let r=0;r<rows;r++){
  for(let c=0;c<cols;c++){
   if(map[r][c]===1){
    ctx.fillStyle="blue";
    ctx.fillRect(c*tile,r*tile,tile,tile);
   }
   if(map[r][c]===2){
    ctx.fillStyle="white";
    ctx.beginPath();
    ctx.arc(c*tile+15,r*tile+15,4,0,Math.PI*2);
    ctx.fill();
   }
  }
 }

 // Pacman
 ctx.fillStyle="yellow";
 ctx.beginPath();
 ctx.arc(pacman.x*tile+15,pacman.y*tile+15,15,0.2*Math.PI,1.8*Math.PI);
 ctx.lineTo(pacman.x*tile+15,pacman.y*tile+15);
 ctx.fill();

 ctx.fillStyle="black";
 ctx.beginPath();
 ctx.arc(pacman.x*tile+20,pacman.y*tile+8,3,0,Math.PI*2);
 ctx.fill();

 // Ghosts
 ghosts.forEach(g=>{
  ctx.fillStyle=g.color;
  ctx.beginPath();
  ctx.arc(g.x*tile+15,g.y*tile+15,15,Math.PI,0);
  ctx.lineTo(g.x*tile+30,g.y*tile+30);
  ctx.lineTo(g.x*tile,g.y*tile+30);
  ctx.fill();

  ctx.fillStyle="white";
  ctx.beginPath();
  ctx.arc(g.x*tile+10,g.y*tile+12,4,0,Math.PI*2);
  ctx.arc(g.x*tile+20,g.y*tile+12,4,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="black";
  ctx.beginPath();
  ctx.arc(g.x*tile+10,g.y*tile+12,2,0,Math.PI*2);
  ctx.arc(g.x*tile+20,g.y*tile+12,2,0,Math.PI*2);
  ctx.fill();
 });
}

function loop(){
 update();
 draw();
 requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
